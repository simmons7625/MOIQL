# Configuration for Objective-Dimensional Soft Inverse Q-Learning (OD-SQIL)

# Expert data source
# - Environment name is auto-detected from train_dir path (dst_train -> deep_sea_treasure, highway_train -> mo-highway)
# - All environment settings are loaded from expert_dir/train_dir/config.yaml
expert_dir: "simulation_results/20251026_201017/"
n_trajectories: 100  # Number of trajectories to use from expert dataset

# Network architecture
hidden_dim: 256

# IQL-specific hyperparameters
lr: 1.0e-4  # Learning rate
gamma: 0.99  # Discount factor
mismatch_coef: 1.0  # Coefficient for mismatch regularization term
tau: 0.005  # Expectile parameter for value function update

# Training settings
batch_size: 1  # Batch size for critic updates
actor_batch_size: 8  # Batch size for actor updates
n_updates: 10000  # Total number of training updates

# State Space Model (SSM) for preference prediction
ssm_type: "neural"  # Options: "pf" (particle filter), "ekf" (extended kalman filter), "neural"

# Particle Filter settings (used if ssm_type == "pf")
particle_filter:
  n_particles: 1000
  process_noise: 0.01
  observation_noise: 0.05
  initial_noise: 1.0

# Extended Kalman Filter settings (used if ssm_type == "ekf")
ekf:
  process_noise: 0.01
  observation_noise: 0.1
  initial_variance: 0.1

# Neural SSM settings (used if ssm_type == "neural")
neural_ssm:
  hidden_dim: 64
  n_layers: 2
  learning_rate: 0.001

# Device
device: "cuda"

# Logging
use_wandb: false
wandb_project: "MOIQL"
save_dir: "moiql_results"

# Evaluation
eval_interval: 1000  # Evaluate every N updates
eval_episodes: 100  # Number of episodes for evaluation
